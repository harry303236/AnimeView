# 玩具資料瀏覽器

一個簡單易用的 Web 應用程式，用於瀏覽和搜尋 Excel 表格中的玩具商品資料。

## 🎯 功能特色

- ✅ **自動讀取 Excel**：自動載入 `list.xlsx` 中的所有頁籤和資料
- ✅ **分頁瀏覽**：每個 Excel 頁籤對應一個分類（如：火影、航海王、龍珠等）
- ✅ **智能搜尋**：自動提取關鍵詞並生成 Bing 圖片搜尋連結
- ✅ **按需載入**：點擊預覽時才進行搜尋，啟動速度快
- ✅ **內嵌預覽**：在右側 iframe 中直接瀏覽搜尋結果，無需切換頁面
- ✅ **快取機制**：自動快取資料，加快後續載入速度

## 📁 專案結構

```
toyz/
├── list.xlsx              # Excel 資料檔案（請放在此處）
├── backend/
│   ├── app.py            # Flask 後端伺服器
│   ├── requirements.txt  # Python 套件依賴
│   └── data_cache.json   # 資料快取（自動生成）
├── frontend/
│   └── index.html        # 前端網頁
└── Readme.md            # 使用說明（本檔案）
```

## 🚀 快速開始（一鍵啟動）

### 方式一：一鍵啟動（推薦）⭐

直接執行根目錄的 `main.py`，系統會自動：
- ✅ 檢查並安裝必要套件
- ✅ 啟動後端伺服器
- ✅ 自動開啟瀏覽器

```bash
python main.py
```

**就這麼簡單！** 🎉

### 方式二：手動啟動

如果需要手動控制，可以分別啟動：

#### 1. 安裝 Python 套件

```bash
cd backend
pip install -r requirements.txt
```

#### 2. 啟動後端伺服器

```bash
cd backend
python app.py
```

伺服器將在 `http://localhost:5000` 啟動

#### 3. 開啟瀏覽器

在瀏覽器中打開：`http://localhost:5000`

## 📝 使用方式

### 1️⃣ **準備 Excel 檔案**

將您的 Excel 檔案命名為 `list.xlsx`，並放在專案根目錄（與 `backend` 和 `frontend` 資料夾同層）

#### Excel 格式要求：
- 檔案名稱：`list.xlsx`（必須）
- 檔案格式：`.xlsx`（不支援舊版 `.xls`）
- 資料位置：**B 欄**存放商品名稱
- 頁籤：每個頁籤代表一個分類

#### Excel 範例：

| A欄 | B欄（商品名稱） | C欄 | D欄 |
|-----|---------------|-----|-----|
| ... | 一番賞 航海王 ROAD TO DAWN【1套6箱】80抽 | ... | ... |
| ... | Look UP系列 航海王 香克斯【帶限定布袋】 | ... | ... |

### 2️⃣ **瀏覽商品**

1. 開啟網頁 `http://localhost:5000`
2. 點擊頂部的頁籤切換分類（火影、航海王、龍珠等）
3. 在左側商品列表中點擊「👁️ 預覽」按鈕
4. 右側會顯示該商品的 Bing 圖片搜尋結果

### 3️⃣ **更新資料**

#### 方式 A：使用網頁「重新載入」按鈕（推薦）
1. 替換專案根目錄的 `list.xlsx` 檔案
2. 在網頁右上角點擊「🔄 重新載入」按鈕
3. 系統會自動清除快取並重新讀取 Excel

#### 方式 B：手動刪除快取
1. 替換專案根目錄的 `list.xlsx` 檔案
2. 刪除 `backend/data_cache.json` 檔案
3. 刷新網頁（F5）

## 🔧 技術架構

### 後端（Backend）
- **Flask**：Python Web 框架
- **Pandas**：Excel 檔案讀取
- **Flask-CORS**：跨域請求支援

### 前端（Frontend）
- **HTML/CSS/JavaScript**：純前端，無需 Node.js
- **Iframe**：內嵌 Bing 圖片搜尋結果

### 搜尋策略
- 自動提取商品名稱關鍵詞（移除括號內容、數量、規格等）
- 添加「手辦 figure」關鍵字提高搜尋準確度
- 使用 Bing 圖片搜尋，無 CAPTCHA 驗證問題

## 📊 API 端點

### GET `/api/data`
獲取 Excel 資料（不含搜尋 URL）

**回應範例：**
```json
{
  "火影": [
    { "name": "火影忍者 佐助手辦" },
    { "name": "火影忍者 鳴人手辦" }
  ],
  "航海王": [
    { "name": "一番賞 航海王 路飛" }
  ]
}
```

### GET `/api/search?q=商品名稱`
為指定商品生成搜尋 URL

**回應範例：**
```json
{
  "url": "https://www.bing.com/images/search?q=..."
}
```

### GET `/api/refresh`
清除快取並重新讀取 Excel 檔案

## ⚠️ 注意事項

1. **檔案名稱**：Excel 檔案必須命名為 `list.xlsx`
2. **檔案位置**：放在專案根目錄（與 `backend` 資料夾同層）
3. **商品資料**：必須在 B 欄
4. **Python 版本**：建議使用 Python 3.8 以上
5. **快取更新**：更新 Excel 後記得點擊「重新載入」按鈕

## 🛑 停止服務

### 使用一鍵啟動時
在終端機按 **Ctrl+C** 即可停止服務

### 手動啟動時
在終端機按 **Ctrl+C** 停止後端伺服器

## 🐛 常見問題

### Q: 如何啟動應用程式？
**A:** 最簡單的方式是執行 `python main.py`，系統會自動啟動所有服務並開啟瀏覽器。

### Q: 為什麼頁面顯示「0 items」？
**A:** 請檢查：
- `list.xlsx` 是否放在正確位置（專案根目錄）
- 後端伺服器是否正常啟動（使用 `python main.py` 可自動檢查）
- 瀏覽器控制台是否有錯誤訊息

### Q: 更新 Excel 後資料沒變？
**A:** 點擊網頁右上角的「🔄 重新載入」按鈕，或手動刪除 `backend/data_cache.json`

### Q: 搜尋結果不準確？
**A:** 系統會自動提取關鍵詞並優化搜尋。如果仍不準確，可以在 `backend/app.py` 的 `extract_keywords()` 函數中調整關鍵詞提取邏輯。

### Q: 能否更改搜尋引擎？
**A:** 可以！在 `backend/app.py` 的 `generate_search_url()` 函數中修改搜尋 URL。目前使用 Bing 圖片搜尋。

## 📄 授權

此專案為個人使用工具。

---

**開發時間：** 2026-01  
**最後更新：** 2026-01-12


